#!/bin/bash
#SBATCH -n 40
#SBATCH -N 1
#SBATCH --mem=200G
#SBATCH --time=24:00:00
#SBATCH --mail-type=ALL
#SBATCH --account= account name


# Load necessary modules
module purge
module load bluebear
module load bear-apps/2023a
module load Trim_Galore/0.6.5-GCCcore-8.3.0-Java-11-Python-3.7.4

# Define input/output directories 
input_dir= "/path/to/directory"
output_dir="/path/to/directory"

# Create the output directory if it doesnâ€™t exist
mkdir -p "$output_dir"

# Safety measure: Exit script if any command fails
set -e  

echo "Starting Trim Galore processing..."
for f in "$input_dir"/*.fastq.gz; do
    echo "Processing: $f"
    trim_galore \
        -q 20 \
        --fastqc_args "--outdir $output_dir" \
        --illumina \
        --gzip \
        -o "$output_dir" \
        --length 20 "$f"
done

echo "Trimming and FastQC completed."
